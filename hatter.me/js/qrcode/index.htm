<html>
<head>
<title>Generate QR Code</title>

</head>
<body>

<div style="height:300px;">
<table width="100%" style="margin-top:20px;">
<tr>
<td valign="top">
  <table width="100%">
  <tr>
  <td>
    Select: <select id="type" style="margin-bottom:10px;width: 200px;" onchange="changeType();">
      <option value="t_text">Text</option>
      <option value="t_sms">SMS</option>
      <option value="t_wifi">WIFI</option>
    </select>
  </td>
  <td align="right">
    <button style="width:300px;height:30px;font-size:12px;" onclick="makeQrCode();">Generate QR Code</button>
  </td>
  </tr>
  </table>
</td>
<td style="width:400px;" align="center" rowspan="2">
  <div id="output" style="margin-top:0px;"></div>
</td>
</tr>
<tr>
<td valign="top">
  <div class="t_" id="t_text">
    <textarea name="input" style="width:100%;height:180px;font-size:18px;"></textarea>
  </div>
  <div class="t_" id="t_sms" style="display:none;">
    Phone No: <input type="text" name="no" style="width:300px;"><br>
    Text:<br>
    <textarea name="input" style="width:100%;height:180px;font-size:18px;"></textarea>
  </div>
  <div class="t_" id="t_wifi" style="display:none;">
    SSID: <input type="text" name="ssid" style="width:300px;"><br>
    Password: <input type="text" name="password" style="width:300px;"><br>
    <select name="network">
      <option value="WEP">WEP</option>
      <option value="WPA">WPA/WPA2</option>
      <option value="nopass">No encryption</option>
    </select>
  </div>
</td>
</tr>
</table>
</div>
<hr>
<i>Thanks: jQuery, jquery.qrcode, http://www.d-project.com/</i>

<script type="text/javascript" src="jquery-1.5.2.js"></script>
<script type="text/javascript" src="qrcode.js"></script>
<script type="text/javascript" src="jquery.qrcode.js"></script>
<script type="text/javascript">
var _countBits = function(_c) {
    var cnt = 0;
    while(_c > 0) {
        cnt++;
        _c = _c >>> 1;
    }
    return cnt;
};
function UnicodeToUtf8Bytes2(code) {
        if ((code == null) || (code < 0) ||
        (code > (Math.pow(2, 31) -1))) {
        return ["?".charCodeAt(0)];
    }
    if (code < 0x80) {
        return [code];
    }
    var arr = [];
    while ((code >>> 6) > 0) {
        arr.push(0x80 | (code & 0x3F));
        code = code >>> 6;
    }
    if ((arr.length + 2 + (_countBits(code))) > 8) {
        arr.push(0x80 | code);
        code = 0;
    }
    var pre = 0x80;
    for (var i = 0; i < arr.length; i++) {
      pre |= (0x80 >>> (i + 1));
    }
    arr.push(pre | code);
    return arr.reverse();
}

QR8bitByte.prototype.getLength = function(buffer) {
  var len = 0;
  for (var i = 0; i < this.data.length; i++) {
    var bytes = UnicodeToUtf8Bytes2(this.data.charCodeAt(i));
    len += bytes.length;
  }
  return len;
};

QR8bitByte.prototype.write = function(buffer) {
  for (var i = 0; i < this.data.length; i++) {
    var bytes = UnicodeToUtf8Bytes2(this.data.charCodeAt(i));
    for (var x = 0; x < bytes.length; x++) {
      buffer.put(bytes[x], 8);
    }
  }
};
</script>
<script type="text/javascript">
function changeType() {
  var selTy = jQuery("#type")[0].value;
  jQuery(".t_").each(function(i, e) {
    e.style.display = (selTy == e.id)? "": "none";
  });
}

function item(id) {
  var selTy = jQuery("#type")[0].value;
  return jQuery("#" + selTy + " *[name=\"" + id + "\"]")[0];
}

qrStrJoinMap = {
  "t_text": function() {
    return item("input").value;
  },
  "t_sms": function() {
    var no = item("no").value;
    var text = item("input").value;
    return "smsto:" + no + ":" + text;
  },
  "t_wifi": function() {
    var ssid = item("ssid").value;
    var password = item("password").value;
    var network = item("network").value;
    return "WIFI:S:" + ssid + ";T:" + network + ";P:" + password + ";;";
  }
};

function makeQrCode() {
  document.getElementById("output").innerHTML = "";
  jQuery('#output').qrcode({
    text: qrStrJoinMap[jQuery("#type")[0].value](),
    correctLevel : QRErrorCorrectLevel.M
  });
}
</script>

</body>
</html>
