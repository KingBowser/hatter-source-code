#summary HotSpot问题诊断
#sidebar TableOfContents

=HotSpot问题诊断=
查找HotSpot相关的问题需要根据现象判断，对现象简单分类如下：

==HotSpot异常退出==
这个问题比较棘手，因为通常JVM异常退出是JVM自身的Bug，所以一般需要读懂JVM源代码才能够找到/解决这类Bug。

==应用停止处理业务逻辑==
这种情况需要查看服务器Load是不是Load过高导致不处理正常业务逻辑，参看 `[应用Load过高]` 或 `[应用占用内存过高]` 。如果Load正常且内存占用也正常则需要通过命令 `jstack` 查看堆栈情况，分析程序未正常工作的原因。此类情况有可能是：
 * 数据库锁，更新/查询/删除数据未提交
 * 程序死锁，不恰当的使用Lock
 * 网络IO操作未返回，如未设置超时时间且当网络异常时有可能出现超时但无法继续执行的情况

==应用Load过高==
这种情况可以使用 `jtop` 查看，通过对堆栈对CPU使用量排序，查找出问题的Java代码。

==应用占用内存过高，发生OOME异常==
这种情况也可使用 `jtop` 查看，通过参数 `--sortmem` ，查找对的Java代码。还可以通过 `jmap -histo` 查找每个类的实例数据及占用的内存大小，也可通过 `histodiff` 查找该断时间内创建的对象情况。

===参考资料===