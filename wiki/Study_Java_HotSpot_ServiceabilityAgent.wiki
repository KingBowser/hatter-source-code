#summary HotSpot Serviceability
#sidebar TableOfContents

<b>The Serviceability Agent(SA).</b> The Serviceability Agent is a Sun private component in the HotSpot repository that was developed by HotSpot engineers to assist in debugging HotSpot. They then realized that SA could be used to craft serviceability tools for end users since it can expose Java objects as well as HotSpot data structures both in running processes and in core files.

[http://hatter-source-code.googlecode.com/svn/trunk/attachments/wiki/java/oop_klass.png]

 * <font color="red"><b>`sun.jvm.hotspot.tools.Tool`</b></font>
  * `sun.jvm.hotspot.tools.FinalizerInfo` <br>查找 `java.lang.ref.Finalizer` 下的queue中的队列信息
  * `sun.jvm.hotspot.tools.FlagDumper` <br>通过 `VM.getVM().getCommandLineFlags()` 打印所有的flag信息
  * `sun.jvm.hotspot.tools.HeapDumper`
  * `sun.jvm.hotspot.tools.HeapSummary` <br>打印内存分配(分带)情况
  * `sun.jvm.hotspot.tools.JInfo`
  * `sun.jvm.hotspot.tools.JMap`
  * `sun.jvm.hotspot.tools.JSnap`
  * `sun.jvm.hotspot.tools.JStack`
  * `sun.jvm.hotspot.tools.ObjectHistogram`
  * `sun.jvm.hotspot.tools.PermStat`
  * `sun.jvm.hotspot.tools.PMap`
  * `sun.jvm.hotspot.tools.PStack`
  * `sun.jvm.hotspot.tools.StackTrace`
  * `sun.jvm.hotspot.tools.SysPropsDumper` <br>通过 `VM.getVM().getSystemProperties()` 打印 `Properties getProperties()` 的信息
  * `sun.jvm.hotspot.tools.jcore.ClassDump` <br>打印内存中的class内存到文件
  * `sun.jvm.hotspot.tools.joql.JSDB`
  * `sun.jvm.hotspot.tools.joql.JOQL`

 * `sun.jvm.hotspot.runtime.VM`

|| `isCore` || `boolean` ||  ||
|| `isClientCompiler` || `boolean` ||  ||
|| `isServerCompiler` || `boolean` ||  ||
|| `useDerivedPointerTable` || `boolean` ||  ||
|| `isBigEndian` || `boolean` ||  ||
|| `isLP64` || `boolean` ||  ||
|| `isSharingEnabled` || `boolean` ||  ||
|| `isCompressedOopsEnabled` || `boolean` ||  ||
|| `getUseTLAB` || `boolean` ||  ||
|| `isDebugging` || `boolean` ||  ||
|| `wizardMode` || `boolean` ||  ||
|| `getInvocationEntryBCI` || `int` ||  ||
|| `getInvalidOSREntryBCI` || `int` ||  ||
|| `getObjectAlignmentInBytes` || `int` ||  ||
|| `getAddressSize` || `long` ||  ||
|| `getOopSize` || `long` ||  ||
|| `getLogAddressSize` || `long` ||  ||
|| `getIntSize` || `long` ||  ||
|| `getStackBias` || `long` ||  ||
|| `getBytesPerLong` || `int` ||  ||
|| `getMinObjAlignmentInBytes` || `int` ||  ||
|| `getLogMinObjAlignmentInBytes` || `int` ||  ||
|| `getHeapWordSize` || `int` ||  ||
|| `getHeapOopSize` || `int` ||  ||
|| `getOS` || `java.lang.String` ||  ||
|| `getCPU` || `java.lang.String` ||  ||
|| `getVMRelease` || `java.lang.String` ||  ||
|| `getVMInternalInfo` || `java.lang.String` ||  ||
|| `getVM` || `sun.jvm.hotspot.runtime.VM` ||  ||
|| `getBytes` || `sun.jvm.hotspot.runtime.Bytes` ||  ||
|| `getThreads` || `sun.jvm.hotspot.runtime.Threads` ||  ||
|| `getTypeDataBase` || `sun.jvm.hotspot.types.TypeDataBase` ||  ||
|| `getUniverse` || `sun.jvm.hotspot.memory.Universe` ||  ||
|| `getObjectHeap` || `sun.jvm.hotspot.oops.ObjectHeap` ||  ||
|| `getSymbolTable` || `sun.jvm.hotspot.memory.SymbolTable` ||  ||
|| `getStringTable` || `sun.jvm.hotspot.memory.StringTable` ||  ||
|| `getSystemDictionary` || `sun.jvm.hotspot.memory.SystemDictionary` ||  ||
|| `getObjectSynchronizer` || `sun.jvm.hotspot.runtime.ObjectSynchronizer` ||  ||
|| `getJNIHandles` || `sun.jvm.hotspot.runtime.JNIHandles` ||  ||
|| `getInterpreter` || `sun.jvm.hotspot.interpreter.Interpreter` ||  ||
|| `getStubRoutines` || `sun.jvm.hotspot.runtime.StubRoutines` ||  ||
|| `getVMRegImplInfo` || `sun.jvm.hotspot.code.VMRegImpl` ||  ||
|| `getCodeCache` || `sun.jvm.hotspot.code.CodeCache` ||  ||
|| `getRuntime1` || `sun.jvm.hotspot.c1.Runtime1` ||  ||
|| `getDebugger` || `sun.jvm.hotspot.debugger.JVMDebugger` ||  ||
|| `getRevPtrs` || `sun.jvm.hotspot.utilities.ReversePtrs` ||  ||
|| `getCommandLineFlags` || `sun.jvm.hotspot.runtime.VM$Flag[]` || JVM的各种参数  ||
|| `getSystemProperties` || `java.util.Properties` || System.getProperties()的各种参数 ||
 

 * `sun.jvm.hotspot.utilities.*`
  * `CStringUtilities`
  * `ObjectReader`
  * `SystemDictionaryHelper`
 * `sun.jvm.hotspot.oops.*`
  * `OopUtilities`


Visitors:
{{{
sun.jvm.hotspot.asm.InstructionVisitor
	public interface InstructionVisitor {
sun.jvm.hotspot.code.CodeCacheVisitor
	public interface CodeCacheVisitor {
sun.jvm.hotspot.compiler.OopMapVisitor
	public interface OopMapVisitor {
sun.jvm.hotspot.debugger.cdbg.LineNumberVisitor
	public interface LineNumberVisitor {
sun.jvm.hotspot.debugger.cdbg.ObjectVisitor
	public interface ObjectVisitor {
sun.jvm.hotspot.debugger.cdbg.TypeVisitor
	public interface TypeVisitor {
sun.jvm.hotspot.interpreter.BytecodeVisitor
	public interface BytecodeVisitor {
sun.jvm.hotspot.memory.StringTable
	public interface StringVisitor {
sun.jvm.hotspot.memory.SymbolTable
	public interface SymbolVisitor {
sun.jvm.hotspot.memory.SystemDictionary
	public static interface ClassVisitor {
	public static interface ClassAndLoaderVisitor {
sun.jvm.hotspot.oops.HeapVisitor
	public interface HeapVisitor {
sun.jvm.hotspot.oops.OopVisitor
	public interface OopVisitor {
sun.jvm.hotspot.oops.RawHeapVisitor
	public interface RawHeapVisitor extends AddressVisitor {
sun.jvm.hotspot.runtime.AddressVisitor
	public interface AddressVisitor {
sun.jvm.hotspot.runtime.PerfMemory
	public static interface PerfDataEntryVisitor {
sun.jvm.hotspot.utilities.soql.ObjectVisitor
	public interface ObjectVisitor {
}}}


Sample:
{{{
  private void readSystemProperties() {
     InstanceKlass systemKls = getSystemDictionary().getSystemKlass();
     systemKls.iterate(new DefaultOopVisitor() {
                               ObjectReader objReader = new ObjectReader();
                               public void doOop(sun.jvm.hotspot.oops.OopField field, boolean isVMField) {
                                  if (field.getID().getName().equals("props")) {
                                     try {
                                        sysProps = (Properties) objReader.readObject(field.getValue(getObj()));
                                     } catch (Exception e) {
                                        if (Assert.ASSERTS_ENABLED) {
                                           e.printStackTrace();
                                        }
                                     }
                                  }
                               }
                        }, false);
  }
}}}


===参数资料===
`[1].` http://openjdk.java.net/groups/hotspot/docs/Serviceability.html<br>
`[2].` http://rednaxelafx.iteye.com/blog/730461<br>