#summary Mail study.
#sidebar TableOfContents

==Sample: Google Apps Setup==

1. 创建`SPF`记录

[https://support.google.com/a/answer/178723?hl=zh-Hans&ref_topic=2759192 创建 SPF 记录]
[http://www.openspf.org/SPF_Record_Syntax]

创建如下：
{{{
openwebsecurity.org.	2285	IN	TXT	"v=spf1 include:_spf.google.com ~all"
}}}

查询并解释：[https://dmarcian.com/spf-survey/]

测试小工具：http://www.kitterman.com/spf/validate.html

超强测试工具：[http://mxtoolbox.com/spf.aspx]

Google IP 地址范围：[https://support.google.com/a/answer/60764?hl=zh-Hans]

2. 配置`DKIM`

[https://support.google.com/a/answer/180504?hl=zh-Hans&ref_topic=2752442 使用域密钥对电子邮件进行身份验证 - 启用电子邮件签名功能]

DKIM检查工具：http://protodave.com/tools/dkim-key-checker/


3. 创建`DMARC`记录

[https://support.google.com/a/answer/2466563?hl=zh-Hans&ref_topic=2759254 创建 DMARC 记录]

创建如下：
{{{
_dmarc.openwebsecurity.org. 3599 IN	TXT	"v=DMARC1\; p=none\; rua=mailto:hatter@openwebsecurity.org\; ruf=mailto:hatter@openwebsecurity.org"
}}}
查看并解释：[https://dmarcian.com/dmarc-inspector/]

生成`DMARC`小工具：[http://kitterman.com/dmarc/assistant.html]

[https://support.google.com/mail/answer/180707?hl=zh-Hans 电子邮件身份验证]
{{{
当您获取邮件标头之后，请查找“Authentication-Results”（身份验证结果）标头。
如果邮件成功通过 SPF 或 DKIM 身份验证，则会显示“spf=pass”或“dkim=pass”

例如：

Authentication-Results: mr.google.com; 
    spf=pass (google.com: domain of sender@gmail.com designates 10.90.20.10 as permitted sender) smtp.mail=sender@gmail.com; 
    dkim=pass header.i=sender@gmail.com
}}}

检查配置是否OK，发邮件到：
{{{
check-auth@verifier.port25.com
}}}

<hr>

 * http://www.bits.org/publications/security/BITSSecureEmailApr2007.pdf
 * http://www.bits.org/publications/security/BITSSecureBrowserRec091610.pdf
 * http://www.bits.org/publications/security/BITSSenderAuthDeployJun09.pdf
 * http://www.bits.org/publications/security/BITSEmailAuthenticationFeb2013.pdf
 * http://en.wikipedia.org/wiki/Author_Domain_Signing_Practices

查看IP是否在黑名单：[http://www.blacklistalert.org/]

相关RFC：
 * [http://tools.ietf.org/html/rfc5321]
 * [http://tools.ietf.org/html/rfc7001]


===参考资料===
`[1].` http://www.trusteddomain.org/<br>
`[2].` http://www.dkim.org/<br>
`[3].` http://www.opendkim.org/<br>
`[4].` http://www.openspf.org/<br>
`[5].` http://www.dmarc.org/<br>
`[6].` http://dmarc-qa.com/<br>
`[7].` http://www.techrepublic.com/blog/google-in-the-enterprise/send-better-email-configure-spf-and-dkim-for-google-apps/<br>
`[8].` http://jsmtp.com/doc/index.html#!/how_to_sign_with_dkim<br>
`[9].` http://emailstuff.org/authentication<br>
`[10].` http://dkimcore.org/tools/<br>
`[11].` http://yxcwf.wordpress.com/2011/05/30/dkim%E6%8A%80%E6%9C%AF%E8%AF%B4%E6%98%8E/<br>
`[12].` http://www.microsoft.com/senderid<br>